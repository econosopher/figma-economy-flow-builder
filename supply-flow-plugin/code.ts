// (full TypeScript code here from previous answer)
